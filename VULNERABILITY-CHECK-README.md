# Vulnerability Check for Maven Dependencies

This document describes how to check the Maven dependencies in `pom.xml` for security vulnerabilities using the endor-labs MCP server.

## Overview

The project contains 16 Maven dependencies that should be regularly checked for known security vulnerabilities. This directory contains scripts and tools to automate this process.

## Files

- **`check-vulnerabilities.sh`** - Bash script that lists all dependencies and generates a vulnerability report
- **`parse-dependencies.py`** - Python script that parses `pom.xml` and extracts dependencies in JSON format
- **`dependencies-to-check.json`** - JSON file containing all dependencies to check
- **`dependency-list.md`** - Markdown report of all dependencies
- **`vulnerability-check-report.md`** - Generated report with vulnerability scan results

## Dependencies Checked

The following 16 dependencies from `pom.xml` are scanned:

1. `javax.servlet:javax.servlet-api:3.1.0`
2. `org.apache.commons:commons-text:1.9`
3. `mysql:mysql-connector-java:5.1.42`
4. `com.mchange:c3p0:0.9.5.2`
5. `org.jboss.weld:weld-core:1.1.33.Final`
6. `org.apache.logging.log4j:log4j-core:2.3` ‚ö†Ô∏è **CRITICAL**
7. `com.nqzero:permit-reflect:0.3`
8. `org.jboss.arquillian.config:arquillian-config-spi:1.7.0.Alpha12`
9. `org.jboss.arquillian.container:arquillian-container-impl-base:1.7.0.Alpha12`
10. `org.jboss.shrinkwrap.descriptors:shrinkwrap-descriptors-api-base:2.0.0`
11. `org.jboss.shrinkwrap:shrinkwrap-impl-base:1.2.6`
12. `org.mockito:mockito-core:2.28.2`
13. `com.google.errorprone:error_prone_annotations:2.7.1`
14. `org.webjars.bowergithub.webcomponents:webcomponentsjs:2.0.0-beta.3`
15. `org.webjars.bowergithub.webcomponents:shadycss:1.9.1`
16. `org.semver:api:0.9.33`

## Usage

### Quick Start

Run the bash script to generate a vulnerability report:

```bash
./check-vulnerabilities.sh
```

This will create `vulnerability-check-report.md` with preliminary findings.

### Parsing Dependencies

To extract dependencies from `pom.xml` in JSON format:

```bash
python3 parse-dependencies.py
```

This generates:
- `dependencies-to-check.json` - Machine-readable dependency list
- `dependency-list.md` - Human-readable dependency report

### Using endor-labs MCP Server

Each dependency should be checked using the `check_dependency_for_vulnerabilities` tool:

```python
check_dependency_for_vulnerabilities(
    dependency_name='groupId:artifactId',
    ecosystem='maven',
    version='x.y.z'
)
```

**Example for log4j:**
```python
check_dependency_for_vulnerabilities(
    dependency_name='org.apache.logging.log4j:log4j-core',
    ecosystem='maven',
    version='2.3'
)
```

## Known Critical Vulnerabilities

Based on public vulnerability databases, the following dependencies have known critical security issues:

### 1. log4j-core:2.3 üî¥ CRITICAL

**CVE-2021-44228 (Log4Shell)** - CVSS Score: 10.0
- Remote Code Execution vulnerability
- Affects log4j versions 2.0-beta9 to 2.14.1
- **Recommendation:** Upgrade to 2.17.1 or later immediately

**Additional CVEs:**
- CVE-2021-45046 (CVSS 9.0)
- CVE-2021-45105 (CVSS 7.5)
- CVE-2021-44832 (CVSS 6.6)

### 2. mysql-connector-java:5.1.42 üü° HIGH

**Multiple CVEs** including:
- CVE-2021-22569
- CVE-2018-3258
- **Recommendation:** Upgrade to 8.0.28 or later

### 3. commons-text:1.9 üü° MEDIUM

**CVE-2022-42889** - CVSS Score: 9.8
- Variable interpolation RCE vulnerability
- **Recommendation:** Upgrade to 1.10.0 or later

### 4. c3p0:0.9.5.2 üü° MEDIUM

**CVE-2019-5427** - CVSS Score: 7.5
- XML External Entity (XXE) vulnerability
- **Recommendation:** Upgrade to 0.9.5.4 or later

## Automation

### GitHub Actions Workflow

Add this to `.github/workflows/vulnerability-scan.yml`:

```yaml
name: Vulnerability Scan

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: '0 0 * * 0'  # Weekly on Sunday

jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.x'
      
      - name: Parse dependencies
        run: python3 parse-dependencies.py
      
      - name: Check vulnerabilities
        run: ./check-vulnerabilities.sh
      
      - name: Upload reports
        uses: actions/upload-artifact@v2
        with:
          name: vulnerability-reports
          path: |
            vulnerability-check-report.md
            dependency-list.md
            dependencies-to-check.json
```

## Manual Verification

You can also use other vulnerability scanning tools:

### OWASP Dependency-Check
```bash
mvn org.owasp:dependency-check-maven:check
```

### Snyk
```bash
snyk test
```

### GitHub Dependabot

Enable Dependabot in your repository settings for automatic vulnerability alerts.

## Remediation Priority

1. **CRITICAL** - Upgrade log4j-core immediately
2. **HIGH** - Update mysql-connector-java
3. **MEDIUM** - Update commons-text and c3p0
4. **LOW** - Review remaining dependencies for updates

## Next Steps

1. Review the vulnerability findings in `vulnerability-check-report.md`
2. Update critical dependencies in `pom.xml`
3. Test the application after updates
4. Re-run vulnerability scans to verify fixes
5. Set up automated scanning in CI/CD pipeline

## Support

For issues with the endor-labs MCP server, consult the Endor Labs documentation or contact support.

## License

This vulnerability checking framework is part of the app-java-demo project.
